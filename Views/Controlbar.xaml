<UserControl x:Class="FFmpegApi.Views.Controlbar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:FFmpegApi.Views"
             mc:Ignorable="d"
             Height="180"
             Background="#121212" Width="580">

    <UserControl.Resources>
        <LinearGradientBrush x:Key="OrangeGradient" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#FF7A18" Offset="0"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="OrangeYellowGradient" StartPoint="1,0" EndPoint="0,0">
            <GradientStop Color="#FF7A18" Offset="0"/>
            <GradientStop Color="#FFB629" Offset="1"/>
        </LinearGradientBrush>

        <!-- Icon Button Style -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="Background" Value="#242424"/>
            <Setter Property="Foreground" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="b"
                        Background="{TemplateBinding Background}"
                        CornerRadius="10">
                            <ContentPresenter
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b"
                                Property="Background"
                                Value="#2E2E2E"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Drop Shadow Effect -->
        <DropShadowEffect x:Key="DropShadow"
                  BlurRadius="14"
                  ShadowDepth="0"
                  Color="#000000"
                  Opacity="0.4"/>

        <!-- Play Button Style -->
        <Style x:Key="PlayButton" TargetType="Button"
       BasedOn="{StaticResource IconButton}">
            <Setter Property="Width" Value="44"/>
            <Setter Property="Height" Value="44"/>
            <Setter Property="Background" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="Foreground" Value="#121212"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="b"
                        Background="{TemplateBinding Background}"
                        CornerRadius="22"
                        Effect="{StaticResource DropShadow}">
                            <ContentPresenter
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b"
                                Property="Background"
                                Value="#FFB629"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Slider Text Style -->
        <Style x:Key="SliderText" TargetType="TextBlock">
            <Setter Property="Foreground"  Value="{StaticResource OrangeGradient}"/>
        </Style>

        <!-- Increase Button Style -->
        <Style x:Key="IncreaseButtonStyle" TargetType="RepeatButton">
            <!-- domyślny kolor: przezroczysty -->
            <Setter Property="Background" Value="#50FFFFFF"/>
            <!-- biały z 50% opacity -->
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border x:Name="b" Background="{TemplateBinding Background}" CornerRadius="2"/>
                        <ControlTemplate.Triggers>
                            <!-- hover -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0" Opacity="0.7">
                                            <GradientStop Color="#FFFF7A18" Offset="0"/>
                                            <!-- pomarańczowy -->
                                            <GradientStop Color="#FFFF4500" Offset="1"/>
                                            <!-- czerwony -->
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Decrease Button Style -->
        <Style x:Key="DecreaseButtonStyle" TargetType="RepeatButton">
            <!-- domyślny kolor: przezroczysty -->
            <Setter Property="Background" Value="#50FFFFFF"/>
            <!-- biały z 50% opacity -->
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border x:Name="b" Background="{TemplateBinding Background}" CornerRadius="2"/>
                        <ControlTemplate.Triggers>
                            <!-- hover -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0" Opacity="0.7">
                                            <GradientStop Color="#FFFFD700" Offset="0"/>
                                            <!-- żółty -->
                                            <GradientStop Color="#FFFF7A18" Offset="1"/>
                                            <!-- pomarańczowy -->
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Slider Template Style -->
        <Style x:Key="SliderTemplate" TargetType="Slider">
            <Setter Property="Height" Value="4"/>
            <Setter Property="Background" Value="#2A2A2A"/>
            <Setter Property="Foreground" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid VerticalAlignment="Center">
                            <Track x:Name="PART_Track"
                           VerticalAlignment="Center">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton 
                                        Command="Slider.DecreaseLarge"
                                        Style="{StaticResource DecreaseButtonStyle}" />
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton 
                                        Command="Slider.IncreaseLarge"
                                        Style="{StaticResource IncreaseButtonStyle}" />
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb x:Name="PART_Thumb" Width="10" Height="10" Background="{StaticResource OrangeGradient}" VerticalAlignment="Center">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <!-- NEGATYWNY MARGIN żeby Thumb wychodził nad track -->
                                                <Ellipse Fill="{TemplateBinding Background}" Width="10" Height="10" Margin="0,-3,0,-3"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBox arrow style -->
        <Style x:Key="ComboBoxArrowButton" TargetType="ToggleButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Background="{TemplateBinding Background}" 
                        BorderBrush="{TemplateBinding BorderBrush}" 
                        BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="Transparent"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="Transparent"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBox Item Style -->
        <Style x:Key="DarkComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#242424"/>
            <Setter Property="Foreground" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="BorderBrush" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Height" Value="22"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6">
                                <DockPanel>
                                    <ToggleButton        
                                Style="{StaticResource ComboBoxArrowButton}"
                                DockPanel.Dock="Right"
                                IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                Background="Transparent"
                                BorderThickness="0"
                                Width="18"
                                Content="▼"
                                Foreground="#FF7A18"/>
                                    <ContentPresenter
                                        Content="{TemplateBinding SelectionBoxItem}"
                                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                        Margin="6,0"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Left"/>
                                </DockPanel>
                            </Border>
                            <!-- DROPDOWN -->
                            <Popup IsOpen="{TemplateBinding IsDropDownOpen}"
                           Placement="Bottom"
                           AllowsTransparency="True"
                           Focusable="False">
                                <Border Background="#242424"
                                BorderBrush="#FF7A18"
                                BorderThickness="1"
                                CornerRadius="6"
                                Padding="2">
                                    <ScrollViewer>
                                        <StackPanel IsItemsHost="True"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--<ComboBoxItem container style-->
        <Style x:Key="DarkComboBoxItem" TargetType="ComboBoxItem">
            <Setter Property="Background" Value="#242424"/>
            <Setter Property="Foreground" Value="{StaticResource OrangeGradient}"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="b"
                        Background="{TemplateBinding Background}">
                            <ContentPresenter/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b"
                                Property="Background"
                                Value="#FF7A18"/>
                                <Setter Property="Foreground"
                                Value="#121212"/>
                            </Trigger>

                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="b"
                                Property="Background"
                                Value="#FF7A18"/>
                                <Setter Property="Foreground"
                                Value="#121212"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    <Border Background="#1A1A1A"
            CornerRadius="14"
            Padding="16"
            Margin="12,12,12,10">

        <Grid Margin="0,-6,0,-6">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>
            
            <!-- CENTER: TIMELINE -->
            <StackPanel Grid.Column="1" Grid.Row="1"
                        Margin="20,0"
                        VerticalAlignment="Center">

                <Slider x:Name="PositionSlider" 
                        Style="{StaticResource SliderTemplate}"
                        Height="4"
                        Minimum="0"
                        Maximum="100"
                        Value="30"/>

                <DockPanel Margin="0,6,0,0">
                    <TextBlock x:Name="PositionTextbox" 
                               Text="01:24" 
                               Style="{StaticResource SliderText}"
                               DockPanel.Dock="Left"/>

                    <TextBlock x:Name="DurationTextbox" 
                               Text="/ 03:45" 
                               Style="{StaticResource SliderText}"
                               DockPanel.Dock="Right"/>
                </DockPanel>
            </StackPanel>

            <!-- RIGHT: VOLUME -->
            <StackPanel Grid.Column="2" Grid.Row="1"
                        Orientation="Horizontal"
                        VerticalAlignment="Center">

                <Button x:Name="MuteBtn" Style="{StaticResource IconButton}"
                        Content="🔊"
                        Margin="0,0,8,0"/>

                <Slider x:Name="VolumeSlider" Style="{StaticResource SliderTemplate}" Width="90"
                        Height="4"
                        Minimum="0"
                        Maximum="1"
                        Value="0.8"/>
            </StackPanel>
            <Label x:Name="MediaTitle" Content="Media Title" Margin="0,0,0,0" VerticalAlignment="Stretch" Grid.ColumnSpan="3" FontWeight="Bold" Foreground="{StaticResource OrangeGradient}" HorizontalAlignment="Stretch" >
                <Label.Effect>
                    <DropShadowEffect BlurRadius="7"
                        ShadowDepth="1"
                        Color="#ffffff"
                        Opacity="0.4"/>
                </Label.Effect>
            </Label>
            <StackPanel Orientation="Horizontal"
                VerticalAlignment="Center" Grid.Row="1">

                <Button x:Name="PreviouseBtn" Style="{StaticResource IconButton}"
                    Content="⏮"
                    Margin="0,0,10,0"/>

                <Button x:Name="PlayBtn"
                    Style="{StaticResource PlayButton}"
                    Content="▶"
                    Margin="0,0,10,0"/>

                <Button x:Name="NextBtn" Style="{StaticResource IconButton}"
                    Content="⏭"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal"
                VerticalAlignment="Center" Grid.Row="2" Grid.ColumnSpan="3">

                <Button x:Name="OpenFileBtn" Style="{StaticResource IconButton}"
                    Content="📁"
                    Margin="0,0,10,0"
                    Click="OpenSubBtn_Click"/>

                <Button x:Name="OpenUrlBtn" Style="{StaticResource IconButton}"
                    Content="🌐"
                    Margin="0,0,10,0"
                    Click="OpenUrlBtn_Click"/>

                <Button x:Name="OpenSubBtn" Style="{StaticResource IconButton}"
                    Content="💬"
                    Margin="0,0,10,0"
                    Click="OpenSubBtn_Click"/>

                <Button x:Name="OpenPlaylistBtn" Style="{StaticResource IconButton}"
                    Content="☰"
                    Margin="0,0,10,0"
                    Click="OpenPlaylistBtn_Click"/>

                <Button x:Name="FullscreenBtn" Style="{StaticResource IconButton}"
                    Content="⛶"
                    Margin="0,0,10,0"
                    Click="FullscreenBtn_Click"/>

                <ComboBox x:Name="RepeatComboBox"
                      Width="76"
                      Style="{StaticResource DarkComboBox}"
                      ItemContainerStyle="{StaticResource DarkComboBoxItem}"
                      Margin="0,0,10,0">    
                    <ComboBoxItem Content="None" IsSelected="True"/>
                    <ComboBoxItem Content="All"/>
                    <ComboBoxItem Content="One"/>
                    <ComboBoxItem Content="Random"/>
                </ComboBox>

                <Button x:Name="EqualizerBtn"
                    Style="{StaticResource IconButton}"
                    Content="🎛"
                    Margin="0,0,10,0"
                    Click="EqualizerBtn_Click"/>

                <Button x:Name="KeyboardShortcutsBtn"
                    Style="{StaticResource IconButton}"
                    Content="⌨"
                    Margin="0,0,10,0"/>
                
                <Button x:Name="HelpBtn"
                    Style="{StaticResource IconButton}"
                    Content="❓"
                    Margin="0,0,10,0"/>

                <Popup x:Name="EqualizerPopup"
                   Placement="Bottom"
                   PlacementTarget="{Binding ElementName=EqualizerBtn}"
                   StaysOpen="False"
                   AllowsTransparency="True"
                   PopupAnimation="None">
                    <!-- wyłączamy wbudowany Fade -->

                    <Border x:Name="EqualizerBorder"
                        Background="#1A1A1A"
                        BorderBrush="#FF7A18"
                        BorderThickness="1"
                        CornerRadius="10"
                        Padding="12"
                        Margin="0,6,0,0"
                        RenderTransformOrigin="0.5,0">

                        <!-- transform do slide -->
                        <Border.RenderTransform>
                            <TranslateTransform Y="-20"/>
                        </Border.RenderTransform>

                        <!-- PANEL EQ -->
                        <StackPanel x:Name="EqStackPanel" Orientation="Horizontal">
                            <!-- Przykładowe pasma -->
                            <StackPanel Margin="6">
                                <TextBlock Text="60Hz" Foreground="{StaticResource OrangeGradient}" FontSize="10" HorizontalAlignment="Center"/>
                                <Slider x:Name="Equalizer60Hz" 
                                        Style="{StaticResource SliderTemplate}"
                                        Orientation="Vertical" 
                                        Height="120" 
                                        Minimum="-12" 
                                        Maximum="12" 
                                        Value="0"
                                        Foreground="#FF7A18" 
                                        Background="#2A2A2A"/>
                            </StackPanel>

                            <StackPanel Margin="6">
                                <TextBlock Text="250Hz" Foreground="{StaticResource OrangeGradient}" FontSize="10" HorizontalAlignment="Center"/>
                                <Slider x:Name="Equalizer250Hz" 
                                        Style="{StaticResource SliderTemplate}"
                                        Orientation="Vertical" 
                                        Height="120" 
                                        Minimum="-12" 
                                        Maximum="12" 
                                        Value="0"
                                        Foreground="#FF7A18" 
                                        Background="#2A2A2A"/>
                            </StackPanel>

                            <StackPanel Margin="6">
                                <TextBlock Text="1k" Foreground="{StaticResource OrangeGradient}" FontSize="10" HorizontalAlignment="Center"/>
                                <Slider x:Name="Equalizer1k" 
                                        Style="{StaticResource SliderTemplate}"
                                        Orientation="Vertical"
                                        Height="120" 
                                        Minimum="-12"
                                        Maximum="12" 
                                        Value="0"
                                        Foreground="#FF7A18"
                                        Background="#2A2A2A"/>
                            </StackPanel>

                            <StackPanel Margin="6">
                                <TextBlock Text="4k" Foreground="{StaticResource OrangeGradient}" FontSize="10" HorizontalAlignment="Center"/>
                                <Slider x:Name="Equalizer4k" 
                                        Style="{StaticResource SliderTemplate}"
                                        Orientation="Vertical" 
                                        Height="120" 
                                        Minimum="-12" 
                                        Maximum="12" 
                                        Value="0"
                                        Foreground="#FF7A18" 
                                        Background="#2A2A2A"/>
                            </StackPanel>

                            <StackPanel Margin="6">
                                <TextBlock Text="16k" Foreground="{StaticResource OrangeGradient}" FontSize="10" HorizontalAlignment="Center"/>
                                <Slider x:Name="Equalizer16k" 
                                        Style="{StaticResource SliderTemplate}"
                                        Orientation="Vertical"
                                        Height="120"
                                        Minimum="-12"
                                        Maximum="12" 
                                        Value="0"
                                        Foreground="#FF7A18"
                                        Background="#2A2A2A"/>
                            </StackPanel>

                        </StackPanel>
                    </Border>
                </Popup>
            </StackPanel>

            <Button x:Name="CloseBtn" Grid.ColumnSpan="3" Grid.RowSpan="3"
                Style="{StaticResource IconButton}"
                Content="X"
                VerticalAlignment="Top"
                HorizontalAlignment="Right"
                Margin="0,-30,-35,0"/>
        </Grid>
    </Border>
</UserControl>
